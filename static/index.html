<script>
  function detectarLogo(equipo) {
    const logos = {
      "Real Madrid": "https://upload.wikimedia.org/wikipedia/en/5/56/Real_Madrid_CF.svg",
      "Manchester City": "https://upload.wikimedia.org/wikipedia/en/e/eb/Manchester_City_FC_badge.svg",
      "Boca Juniors": "https://upload.wikimedia.org/wikipedia/en/5/5b/Boca_Juniors_logo.svg",
      "Palmeiras": "https://upload.wikimedia.org/wikipedia/en/1/10/Palmeiras_logo.svg",
      "PSG": "https://upload.wikimedia.org/wikipedia/en/a/a7/Paris_Saint-Germain_F.C..svg",
      "River Plate": "https://upload.wikimedia.org/wikipedia/en/3/3f/Club_Atl%C3%A9tico_River_Plate_logo.svg",
      "Flamengo": "https://upload.wikimedia.org/wikipedia/en/5/5e/Clube_de_Regatas_do_Flamengo_logo.svg",
      "Barcelona": "https://upload.wikimedia.org/wikipedia/en/4/47/FC_Barcelona_%28crest%29.svg",
      "Chelsea": "https://upload.wikimedia.org/wikipedia/en/c/cc/Chelsea_FC.svg"
    };
    return logos[equipo] || "https://via.placeholder.com/40";
  }

  document.getElementById("formulario").addEventListener("submit", async (e) => {
    e.preventDefault();
    const resultado = document.getElementById("resultado");
    resultado.innerHTML = "<p>Procesando...</p>";

    const form = new FormData(e.target);
    const datos = {
      id: form.get("id").trim(),
      momentum: form.get("momentum").trim(),
      xG: parseFloat(form.get("xG")),
      prob_real: parseFloat(form.get("prob_real")),
      prob_implicita: parseFloat(form.get("prob_implicita")),
      cuota: parseFloat(form.get("cuota")),
      minuto: parseInt(form.get("minuto"))
    };

    try {
      const respuesta = await fetch("https://backend-tactico-9lld.onrender.com/analizar/", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(datos),
      });

      if (!respuesta.ok) {
        const errorTexto = await respuesta.text();
        throw new Error(`Error ${respuesta.status}: ${errorTexto}`);
      }

      const json = await respuesta.json();
      const logoA = detectarLogo(json.equipoA);
      const logoB = detectarLogo(json.equipoB);

      resultado.innerHTML = `
        <div class="tarjeta-senal">
          <div class="encabezado">
            <img src="${logoA}" alt="${json.equipoA}" class="bandera">
            <h2>${json.equipoA} vs ${json.equipoB}</h2>
            <img src="${logoB}" alt="${json.equipoB}" class="bandera">
          </div>

          <p><strong>âš½ ${json.liga} â€” Min ${json.minuto}Â°</strong></p>
          <p>ğŸ“ˆ <strong>Momentum:</strong> <span class="momentum-alto">${datos.momentum}</span></p>
          <p>ğŸ’¡ <strong>APUESTA:</strong> ${json.equipoA} gana @${json.cuota}</p>
          <p>ğŸ¯ <strong>CONFIANZA:</strong> <span class="confianza-alta">${json.confianza}%</span></p>
          <p>â±ï¸ <strong>VENTANA:</strong> Min ${json.minuto - 2}â€“${json.minuto + 10} | ğŸ’° <strong>TAMAÃ‘O:</strong> 4%</p>
          <p>ğŸ” <strong>RAZÃ“N:</strong> ${json.razon}</p>
          <p>ğŸ“ˆ <strong>VALOR:</strong> ${json.valor}% margen | ğŸ² <strong>PROB REAL:</strong> ${Math.round(json.prob_real * 100)}%</p>
        </div>
      `;
    } catch (error) {
      resultado.innerHTML = `<p style="color:red;">Error: ${error.message}</p>`;
    }
  });
                                               </script>
